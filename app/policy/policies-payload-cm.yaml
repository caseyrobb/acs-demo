apiVersion: v1
data:
  policies-payload.json: |
    {"policies":[{"id":"354cdb7c-09fd-440f-88e6-e90a4a615459","name":"90-Day Image Age (COPY)","description":"Alert on deployments with images that haven't been updated in 90 days","rationale":"Base images are updated frequently with bug fixes and vulnerability patches. Image age exceeding 90 days may indicate a higher risk of vulnerabilities existing in the image.","remediation":"Rebuild your image, push a new minor version (with a new immutable tag), and update your service to use it.","disabled":false,"categories":["DevOps Best Practices","Security Best Practices"],"lifecycleStages":["BUILD","DEPLOY"],"eventSource":"NOT_APPLICABLE","exclusions":[{"name":"","deployment":{"name":"","scope":{"cluster":"","namespace":"kube-system","label":null}},"image":null,"expiration":null},{"name":"","deployment":{"name":"","scope":{"cluster":"","namespace":"istio-system","label":null}},"image":null,"expiration":null}],"scope":[],"severity":"LOW_SEVERITY","enforcementActions":[],"notifiers":[],"lastUpdated":"2023-02-07T23:11:20.067079798Z","SORTName":"","SORTLifecycleStage":"","SORTEnforcement":false,"policyVersion":"1.1","policySections":[{"sectionName":"","policyGroups":[{"fieldName":"Image Age","booleanOperator":"OR","negate":false,"values":[{"value":"90"}]}]}],"mitreAttackVectors":[],"criteriaLocked":false,"mitreVectorsLocked":false,"isDefault":false},{"id":"bfeb85cc-2bdd-4ed1-a0fa-39cd5c062b65","name":"ADD Command used instead of COPY (COPY)","description":"Alert on deployments using a ADD command","rationale":"ADD incorporates a broader set of capabilities than COPY, including the ability to specify URLs as the source argument and automatic unpacking of compressed files onto the local filesystem. The effects of ADD can be unpredictable and can lead to larger images. Unless ADD's additional capabilities are required, COPY is recommended.","remediation":"Replace ADD with COPY when adding new files to the image. Per https://docs.docker.com/develop/develop-images/dockerfile_best-practices, it is better to use RUN curl instead of ADD if you need to access a URL.","disabled":false,"categories":["DevOps Best Practices","Docker CIS"],"lifecycleStages":["BUILD","DEPLOY"],"eventSource":"NOT_APPLICABLE","exclusions":[],"scope":[],"severity":"LOW_SEVERITY","enforcementActions":[],"notifiers":[],"lastUpdated":"2023-02-07T23:11:25.846242916Z","SORTName":"","SORTLifecycleStage":"","SORTEnforcement":false,"policyVersion":"1.1","policySections":[{"sectionName":"","policyGroups":[{"fieldName":"Dockerfile Line","booleanOperator":"OR","negate":false,"values":[{"value":"ADD=.*"}]}]}],"mitreAttackVectors":[],"criteriaLocked":false,"mitreVectorsLocked":false,"isDefault":false},{"id":"bc5022d3-9bd9-4723-99f3-7512c9f239fa","name":"Linux sudo Execution (Enforced)","description":"Detects when the 'sudo' or 'visudo' binary is executed, which can be used to assume root privileges.","rationale":"Processes should not require escalated privileges within containers.","remediation":"Consider using a base image that doesn't have a shell such as SCRATCH or gcr.io/distroless. If not, modify your Dockerfile to use the exec form of CMD/ENTRYPOINT ([\"using braces\"]) instead of the shell form (no braces)","disabled":false,"categories":["System Modification","Privileges"],"lifecycleStages":["RUNTIME"],"eventSource":"DEPLOYMENT_EVENT","exclusions":[],"scope":[],"severity":"HIGH_SEVERITY","enforcementActions":["KILL_POD_ENFORCEMENT","FAIL_KUBE_REQUEST_ENFORCEMENT"],"notifiers":[],"lastUpdated":"2023-02-08T05:14:59.133754425Z","SORTName":"","SORTLifecycleStage":"","SORTEnforcement":false,"policyVersion":"1.1","policySections":[{"sectionName":"","policyGroups":[{"fieldName":"Process Name","booleanOperator":"OR","negate":false,"values":[{"value":"sudo|visudo"}]}]}],"mitreAttackVectors":[{"tactic":"TA0004","techniques":["T1548.003","T1548.004"]}],"criteriaLocked":false,"mitreVectorsLocked":false,"isDefault":false},{"id":"271d715f-2be6-410e-8886-4003d2d79d48","name":"30-Day Scan Age (COPY)","description":"Alert on deployments with images that haven't been scanned in 30 days","rationale":"Out-of-date scans may not identify the most recent CVEs.","remediation":"Integrate a scanner with the StackRox Kubernetes Security Platform to trigger scans automatically.","disabled":false,"categories":["Security Best Practices"],"lifecycleStages":["DEPLOY"],"eventSource":"NOT_APPLICABLE","exclusions":[],"scope":[],"severity":"MEDIUM_SEVERITY","enforcementActions":[],"notifiers":[],"lastUpdated":"2023-02-07T23:11:13.355617463Z","SORTName":"","SORTLifecycleStage":"","SORTEnforcement":false,"policyVersion":"1.1","policySections":[{"sectionName":"","policyGroups":[{"fieldName":"Image Scan Age","booleanOperator":"OR","negate":false,"values":[{"value":"30"}]}]}],"mitreAttackVectors":[],"criteriaLocked":false,"mitreVectorsLocked":false,"isDefault":false}]}
kind: ConfigMap
metadata:
  name: policies-payload
  namespace: stackrox
